"use strict";!function(t,e){"function"==typeof define&&define.amd?define(["es6-promise","base-64","utf8","axios"],function(n,o,s,i){return t.Github=e(n,o,s,i)}):"object"==typeof module&&module.exports?module.exports=e(require("es6-promise"),require("base-64"),require("utf8"),require("axios")):t.Github=e(t.Promise,t.base64,t.utf8,t.axios)}(this,function(t,e,n,o){function s(t){return e.encode(n.encode(t))}t.polyfill&&t.polyfill();var i=function(t){var e=t.apiUrl||"https://api.github.com",n=i._request=function(n,i,u,r,c){function a(){var t=i.indexOf("//")>=0?i:e+i;if(t+=/\?/.test(t)?"&":"?",u&&"object"==typeof u&&["GET","HEAD","DELETE"].indexOf(n)>-1)for(var o in u)u.hasOwnProperty(o)&&(t+="&"+encodeURIComponent(o)+"="+encodeURIComponent(u[o]));return t+("undefined"!=typeof window?"&"+(new Date).getTime():"")}var l={headers:{Accept:c?"application/vnd.github.v3.raw+json":"application/vnd.github.v3+json","Content-Type":"application/json;charset=UTF-8"},method:n,data:u?u:{},url:a()};return(t.token||t.username&&t.password)&&(l.headers.Authorization=t.token?"token "+t.token:"Basic "+s(t.username+":"+t.password)),o(l).then(function(t){r(null,t.data||!0,t.request)},function(t){304===t.status?r(null,t.data||!0,t.request):r({path:i,request:t.request,error:t.status})})},u=i._requestAllPages=function(t,e){var o=[];!function s(){n("GET",t,null,function(n,i,u){if(n)return e(n);o.push.apply(o,i);var r=(u.getResponseHeader("link")||"").split(/\s*,\s*/g),c=null;r.forEach(function(t){c=/rel="next"/.test(t)?t:c}),c&&(c=(/<(.*)>/.exec(c)||[])[1]),c?(t=c,s()):e(n,o)})}()};return i.User=function(){this.repos=function(t,e){1===arguments.length&&"function"==typeof arguments[0]&&(e=t,t={}),t=t||{};var o="/user/repos",s=[];s.push("type="+encodeURIComponent(t.type||"all")),s.push("sort="+encodeURIComponent(t.sort||"updated")),s.push("per_page="+encodeURIComponent(t.per_page||"100")),t.page&&s.push("page="+encodeURIComponent(t.page)),o+="?"+s.join("&"),n("GET",o,null,e)},this.orgs=function(t){n("GET","/user/orgs",null,t)},this.gists=function(t){n("GET","/gists",null,t)},this.notifications=function(t,e){1===arguments.length&&"function"==typeof arguments[0]&&(e=t,t={}),t=t||{};var o="/notifications",s=[];if(t.all&&s.push("all=true"),t.participating&&s.push("participating=true"),t.since){var i=t.since;i.constructor===Date&&(i=i.toISOString()),s.push("since="+encodeURIComponent(i))}if(t.before){var u=t.before;u.constructor===Date&&(u=u.toISOString()),s.push("before="+encodeURIComponent(u))}t.page&&s.push("page="+encodeURIComponent(t.page)),s.length>0&&(o+="?"+s.join("&")),n("GET",o,null,e)},this.show=function(t,e){var o=t?"/users/"+t:"/user";n("GET",o,null,e)},this.userRepos=function(t,e){u("/users/"+t+"/repos?type=all&per_page=100&sort=updated",e)},this.userStarred=function(t,e){u("/users/"+t+"/starred?type=all&per_page=100",function(t,n){e(t,n)})},this.userGists=function(t,e){n("GET","/users/"+t+"/gists",null,e)},this.orgRepos=function(t,e){u("/orgs/"+t+"/repos?type=all&&page_num=1000&sort=updated&direction=desc",e)},this.follow=function(t,e){n("PUT","/user/following/"+t,null,e)},this.unfollow=function(t,e){n("DELETE","/user/following/"+t,null,e)},this.createRepo=function(t,e){n("POST","/user/repos",t,e)}},i.Repository=function(t){function e(t,e){return t===l.branch&&l.sha?e(null,l.sha):void a.getRef("heads/"+t,function(n,o){l.branch=t,l.sha=o,e(n,o)})}var o,u=t.name,r=t.user,c=t.fullname,a=this;o=c?"/repos/"+c:"/repos/"+r+"/"+u;var l={branch:null,sha:null};this.deleteRepo=function(e){n("DELETE",o,t,e)},this.getRef=function(t,e){n("GET",o+"/git/refs/"+t,null,function(t,n,o){return t?e(t):void e(null,n.object.sha,o)})},this.createRef=function(t,e){n("POST",o+"/git/refs",t,e)},this.deleteRef=function(e,s){n("DELETE",o+"/git/refs/"+e,t,function(t,e,n){s(t,e,n)})},this.createRepo=function(t,e){n("POST","/user/repos",t,e)},this.deleteRepo=function(e){n("DELETE",o,t,e)},this.listTags=function(t){n("GET",o+"/tags",null,function(e,n,o){return e?t(e):void t(null,n,o)})},this.listPulls=function(t,e){t=t||{};var s=o+"/pulls",i=[];"string"==typeof t?i.push("state="+t):(t.state&&i.push("state="+encodeURIComponent(t.state)),t.head&&i.push("head="+encodeURIComponent(t.head)),t.base&&i.push("base="+encodeURIComponent(t.base)),t.sort&&i.push("sort="+encodeURIComponent(t.sort)),t.direction&&i.push("direction="+encodeURIComponent(t.direction)),t.page&&i.push("page="+t.page),t.per_page&&i.push("per_page="+t.per_page)),i.length>0&&(s+="?"+i.join("&")),n("GET",s,null,function(t,n,o){return t?e(t):void e(null,n,o)})},this.getPull=function(t,e){n("GET",o+"/pulls/"+t,null,function(t,n,o){return t?e(t):void e(null,n,o)})},this.compare=function(t,e,s){n("GET",o+"/compare/"+t+"..."+e,null,function(t,e,n){return t?s(t):void s(null,e,n)})},this.listBranches=function(t){n("GET",o+"/git/refs/heads",null,function(e,n,o){return e?t(e):void t(null,n.map(function(t){return t.ref.replace(/^refs\/heads\//,"")}),o)})},this.getBlob=function(t,e){n("GET",o+"/git/blobs/"+t,null,e,"raw")},this.getCommit=function(t,e,s){n("GET",o+"/git/commits/"+e,null,function(t,e,n){return t?s(t):void s(null,e,n)})},this.getSha=function(t,e,s){return e&&""!==e?void n("GET",o+"/contents/"+e+(t?"?ref="+t:""),null,function(t,e,n){return t?s(t):void s(null,e.sha,n)}):a.getRef("heads/"+t,s)},this.getStatuses=function(t,e){n("GET",o+"/statuses/"+t,null,e)},this.getTree=function(t,e){n("GET",o+"/git/trees/"+t,null,function(t,n,o){return t?e(t):void e(null,n.tree,o)})},this.postBlob=function(t,e){t="string"==typeof t?{content:t,encoding:"utf-8"}:{content:s(t),encoding:"base64"},n("POST",o+"/git/blobs",t,function(t,n){return t?e(t):void e(null,n.sha)})},this.updateTree=function(t,e,s,i){var u={base_tree:t,tree:[{path:e,mode:"100644",type:"blob",sha:s}]};n("POST",o+"/git/trees",u,function(t,e){return t?i(t):void i(null,e.sha)})},this.postTree=function(t,e){n("POST",o+"/git/trees",{tree:t},function(t,n){return t?e(t):void e(null,n.sha)})},this.commit=function(e,s,u,r){var c=new i.User;c.show(null,function(i,c){if(i)return r(i);var a={message:u,author:{name:t.user,email:c.email},parents:[e],tree:s};n("POST",o+"/git/commits",a,function(t,e){return t?r(t):(l.sha=e.sha,void r(null,e.sha))})})},this.updateHead=function(t,e,s){n("PATCH",o+"/git/refs/heads/"+t,{sha:e},function(t){s(t)})},this.show=function(t){n("GET",o,null,t)},this.contributors=function(t,e){e=e||1e3;var s=this;n("GET",o+"/stats/contributors",null,function(n,o,i){return n?t(n):void(202===i.status?setTimeout(function(){s.contributors(t,e)},e):t(n,o,i))})},this.contents=function(t,e,s){e=encodeURI(e),n("GET",o+"/contents"+(e?"/"+e:""),{ref:t},s)},this.fork=function(t){n("POST",o+"/forks",null,t)},this.listForks=function(t){n("GET",o+"/forks",null,t)},this.branch=function(t,e,n){2===arguments.length&&"function"==typeof arguments[1]&&(n=e,e=t,t="master"),this.getRef("heads/"+t,function(t,o){return t&&n?n(t):void a.createRef({ref:"refs/heads/"+e,sha:o},n)})},this.createPullRequest=function(t,e){n("POST",o+"/pulls",t,e)},this.listHooks=function(t){n("GET",o+"/hooks",null,t)},this.getHook=function(t,e){n("GET",o+"/hooks/"+t,null,e)},this.createHook=function(t,e){n("POST",o+"/hooks",t,e)},this.editHook=function(t,e,s){n("PATCH",o+"/hooks/"+t,e,s)},this.deleteHook=function(t,e){n("DELETE",o+"/hooks/"+t,null,e)},this.read=function(t,e,s){n("GET",o+"/contents/"+encodeURI(e)+(t?"?ref="+t:""),null,function(t,e,n){return t&&404===t.error?s("not found",null,null):t?s(t):void s(null,e,n)},!0)},this.remove=function(t,e,s){a.getSha(t,e,function(i,u){return i?s(i):void n("DELETE",o+"/contents/"+e,{message:e+" is removed",sha:u,branch:t},s)})},this["delete"]=this.remove,this.move=function(t,n,o,s){e(t,function(e,i){a.getTree(i+"?recursive=true",function(e,u){u.forEach(function(t){t.path===n&&(t.path=o),"tree"===t.type&&delete t.sha}),a.postTree(u,function(e,o){a.commit(i,o,"Deleted "+n,function(e,n){a.updateHead(t,n,function(t){s(t)})})})})})},this.write=function(t,e,i,u,r,c){"undefined"==typeof c&&(c=r,r={}),a.getSha(t,encodeURI(e),function(a,l){var f={message:u,content:"undefined"==typeof r.encode||r.encode?s(i):i,branch:t,committer:r&&r.committer?r.committer:void 0,author:r&&r.author?r.author:void 0};a&&404!==a.error||(f.sha=l),n("PUT",o+"/contents/"+encodeURI(e),f,c)})},this.getCommits=function(t,e){t=t||{};var s=o+"/commits",i=[];if(t.sha&&i.push("sha="+encodeURIComponent(t.sha)),t.path&&i.push("path="+encodeURIComponent(t.path)),t.author&&i.push("author="+encodeURIComponent(t.author)),t.since){var u=t.since;u.constructor===Date&&(u=u.toISOString()),i.push("since="+encodeURIComponent(u))}if(t.until){var r=t.until;r.constructor===Date&&(r=r.toISOString()),i.push("until="+encodeURIComponent(r))}t.page&&i.push("page="+t.page),t.perpage&&i.push("per_page="+t.perpage),i.length>0&&(s+="?"+i.join("&")),n("GET",s,null,e)}},i.Gist=function(t){var e=t.id,o="/gists/"+e;this.read=function(t){n("GET",o,null,t)},this.create=function(t,e){n("POST","/gists",t,e)},this["delete"]=function(t){n("DELETE",o,null,t)},this.fork=function(t){n("POST",o+"/fork",null,t)},this.update=function(t,e){n("PATCH",o,t,e)},this.star=function(t){n("PUT",o+"/star",null,t)},this.unstar=function(t){n("DELETE",o+"/star",null,t)},this.isStarred=function(t){n("GET",o+"/star",null,t)}},i.Issue=function(t){var e="/repos/"+t.user+"/"+t.repo+"/issues";this.list=function(t,n){var o=[];for(var s in t)t.hasOwnProperty(s)&&o.push(encodeURIComponent(s)+"="+encodeURIComponent(t[s]));u(e+"?"+o.join("&"),n)},this.comment=function(t,e,o){n("POST",t.comments_url,{body:e},function(t,e){o(t,e)})}},i.Search=function(t){var e="/search/",o="?q="+t.query;this.repositories=function(t,s){n("GET",e+"repositories"+o,t,s)},this.code=function(t,s){n("GET",e+"code"+o,t,s)},this.issues=function(t,s){n("GET",e+"issues"+o,t,s)},this.users=function(t,s){n("GET",e+"users"+o,t,s)}},i};return i.getIssues=function(t,e){return new i.Issue({user:t,repo:e})},i.getRepo=function(t,e){return e?new i.Repository({user:t,name:e}):new i.Repository({fullname:t})},i.getUser=function(){return new i.User},i.getGist=function(t){return new i.Gist({id:t})},i.getSearch=function(t){return new i.Search({query:t})},i});
//# sourceMappingURL=github.min.js.map
